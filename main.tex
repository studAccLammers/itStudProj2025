\documentclass[12pt,a4paper]{article}

\usepackage[utf8]{inputenc}    % Umlaute im UTF-8 Zeichensatz
\usepackage[T1]{fontenc}       % richtige Trennung von Umlauten
\usepackage{amsmath,amssymb}   % Mathematikpakete
\usepackage{amsfonts}
\usepackage{geometry}          % Seitenränder anpassen
\geometry{a2paper, left=25mm, right=25mm, top=20mm, bottom=20mm}
\usepackage{lmodern}           % Schönere Schrift
\usepackage{hyperref}          % Hyperlinks im PDF

\title{Mathematische Darstellung des Optimierungsmodells}
\date{\today}

\begin{document}

\maketitle

\section*{1. Mengen (Sets)}
\begin{itemize}
  \item $m \in M$: Mitarbeiter ($m1, m2$)
  \item $a,\,aa \in A$: Aufträge ($a1, \dots, a15$)
  \item $wd \in WD$: Werktage ($wd1, \dots, wd5$)
  \item $s \in S$: Skills ($s1, \dots, s5$)
  \item $i \in I$: Zeit-Slots pro Tag ($i1, \dots, i30$)
\end{itemize}

\section*{2. Parameter}
\begin{itemize}
  \item $\text{priority}(a)$: Priorität von Auftrag $a$ (1 = am höchsten, 3 = normal).
  \item $\text{expectedHours}(a)$: Erwartete Ausführungsstunden für Auftrag $a$.
  \item $\text{dayWeight}(wd)$: Gewichtung des Wochentags (1 = Montag, ..., 5 = Freitag).
  \item $\text{maxWorkingHours}(m)$: Max. Arbeitsstunden pro Tag.
  \item $\text{maxWorkingHoursWeek}(m)$: Max. Arbeitsstunden pro Woche.
  \item $\text{minWorkingHours}(m)$: Min. Arbeitsstunden pro Tag.
  \item $\text{employeeSkill}(m,s) \in \{0,1\}$: Verfügt Mitarbeiter $m$ über Skill $s$?
  \item $\text{necessarySkill}(a,s) \in \{0,1\}$: Benötigt Auftrag $a$ Skill $s$?
  \item $\text{driveTime}(a,aa)$: Fahrzeit zwischen Aufträgen $a$ und $aa$.
  \item $\text{driveTimeMainStation}(a)$: Fahrzeit zwischen Hauptstation und Auftrag $a$.
\end{itemize}

\section*{3. Variablen}
\begin{itemize}
  \item $x(m,a,wd,i) \in \{0,1\}$: 1, wenn Mitarbeiter $m$ Auftrag $a$ an Tag $wd$ zum Index $i$ durchführt.
  \item $\text{bothContractsConsecutively}(m,a,aa,wd,i) \in \{0,1\}$: 1, wenn zwei Aufträge $a,aa$ an einem Tag $wd$ für Mitarbeiter $m$ hintereinander liegen (Index $i, i+1$).
  \item $\text{isLastContractOnWD}(m,a,wd,i) \in \{0,1\}$: 1, wenn $a$ der letzte Auftrag an $wd$ (Index $i$) für Mitarbeiter $m$ ist.
\end{itemize}

\section*{4. Zielfunktion}
In GAMS ist die Zielfunktion wie folgt definiert:
\[
\begin{aligned}
\max\ \text{obj} 
=\;&
100 \sum_{m,a,wd,i} \frac{x(m,a,wd,i)}{\text{priority}(a) + \text{dayWeight}(wd)} 
\;+\; \sum_{m,a,aa,wd,i} \frac{\text{bothContractsConsecutively}(m,a,aa,wd,i)}{\text{driveTime}(a,aa) + 0.1} \\
&\;+\; \sum_{m,a,wd} \frac{x(m,a,wd,i1)}{\text{driveTimeMainStation}(a) + 0.1}
\;+\; \sum_{m,a,wd,i} \frac{\text{isLastContractOnWD}(m,a,wd,i)}{\text{driveTimeMainStation}(a) + 0.1}.
\end{aligned}
\]

\section*{5. Nebenbedingungen}


\textbf{(nb1) Jeder Auftrag darf höchstens einmal zugewiesen werden:}
\[
\sum_{m,wd,i} x(m,a,wd,i) \;\le\; 1
\quad \forall a \in A.
\]

\textbf{(nb2) Maximale tägliche Arbeitszeit pro Mitarbeiter:}
\[
\sum_{a,i} \bigl[\text{expectedHours}(a)\;x(m,a,wd,i)\bigr]
\;+\; \sum_{a,aa,i} \bigl[\text{driveTime}(a,aa)\;\text{bothContractsConsecutively}(m,a,aa,wd,i)\bigr]
\]
\[
\;+\;
\sum_{a} \bigl[\text{driveTimeMainStation}(a)\;x(m,a,wd,i1)\bigr]
\;+\; 
\sum_{a,i} \bigl[\text{driveTimeMainStation}(a)\;\text{isLastContractOnWD}(m,a,wd,i)\bigr]
\;\;\;\le\;\;\;
\text{maxWorkingHours}(m), 
\quad \forall m,\,wd.
\]

\textbf{(nb3) Maximale wöchentliche Arbeitszeit pro Mitarbeiter:}
\[
\sum_{a,wd,i} \bigl[\text{expectedHours}(a)\;x(m,a,wd,i)\bigr]
\;+\; \sum_{a,aa,wd,i} \bigl[\text{driveTime}(a,aa)\;\text{bothContractsConsecutively}(m,a,aa,wd,i)\bigr]
\]
\[
\;+\;
\sum_{a,wd} \bigl[\text{driveTimeMainStation}(a)\;x(m,a,wd,i1)\bigr]
\;+\; 
\sum_{a,wd,i} \bigl[\text{driveTimeMainStation}(a)\;\text{isLastContractOnWD}(m,a,wd,i)\bigr]
\;\;\;\le\;\;\;
\text{maxWorkingHoursWeek}(m), 
\quad \forall m.
\]

\textbf{(nb4) Skill-Anforderung:}
\[
\left( \prod_{s:\,\text{necessarySkill}(a,s)=1} \text{employeeSkill}(m,s) \right)
\;+\; \text{noSkillNecessary}(a)
\;\;\ge\;\; x(m,a,wd,i),
\quad \forall m,a,wd,i.
\]

\textbf{(nb5) Minimale tägliche Arbeitszeit:}
\[
\sum_{a,i} \bigl[\text{expectedHours}(a)\;x(m,a,wd,i)\bigr]
\;+\; \sum_{a,aa,i} \bigl[\text{driveTime}(a,aa)\;\text{bothContractsConsecutively}(m,a,aa,wd,i)\bigr]
\]
\[
\;+\;
\sum_{a} \bigl[\text{driveTimeMainStation}(a)\;x(m,a,wd,i1)\bigr]
\;+\; 
\sum_{a,i} \bigl[\text{driveTimeMainStation}(a)\;\text{isLastContractOnWD}(m,a,wd,i)\bigr]
\;\;\;\ge\;\;\;
\text{minWorkingHours}(m), 
\quad \forall m,\,wd.
\]

\textbf{(nb6) Ein Mitarbeiter darf an einem Wochentag jeden Index höchstens einmal belegen:}
\[
\sum_{a} x(m,a,wd,i) 
\;\le\; 1, 
\quad \forall m,\,wd,\,i.
\]

\textbf{Kein „Index-Sprung“ (nb\_no\_index\_jumps):}
\[
\sum_{aa} x(m,aa,wd,i) 
\;\le\; 
\sum_{a} x(m,a,wd,i-1),
\quad \forall m,\,wd,\,i>1.
\]

\textbf{Hilfsvariablen für aufeinanderfolgende Aufträge (bothContractsConsecutively):}
\[
\begin{aligned}
\text{bothContractsConsecutively}(m,a,aa,wd,i) &\;\le\; x(m,a,wd,i), \\
\text{bothContractsConsecutively}(m,a,aa,wd,i) &\;\le\; x(m,aa,wd,i+1), \\
\text{bothContractsConsecutively}(m,a,aa,wd,i) &\;\ge\; x(m,a,wd,i) + x(m,aa,wd,i+1) - 1, \\
\text{bothContractsConsecutively}(m,a,aa,wd,i) &\;=\; 0\quad\text{für}\ i = i_{\text{max}}\ (\text{d.h. letzter Index}).
\end{aligned}
\]

\textbf{Hilfsvariablen für den letzten Auftrag des Tages (isLastContractOnWD):}
\[
\begin{aligned}
\text{isLastContractOnWD}(m,a,wd,i) &\;\le\; x(m,a,wd,i), \\
\text{isLastContractOnWD}(m,a,wd,i) &\;\le\; 1\;-\;\sum_{aa}\text{bothContractsConsecutively}(m,a,aa,wd,i), \\
\text{isLastContractOnWD}(m,a,wd,i) &\;\ge\; x(m,a,wd,i)\;-\;\sum_{aa}\text{bothContractsConsecutively}(m,a,aa,wd,i).
\end{aligned}
\]

\end{document}
